<div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; padding: 20px; max-width: 800px; margin: auto; background-color: #ffffff; color: #333;">

    <h1 style="border-bottom: 2px solid #000; padding-bottom: 10px; font-size: 28px;">
        🚀 SoftBank Hackathon: "Delightful Deploy" Cherry팀 전략
    </h1>

    <h2 style="font-size: 24px; margin-top: 30px;">1. 배경 연구: 배포의 "고통" (Pain Points)</h2>
    <p style="font-size: 16px; color: #555;">(회의 주제였던 "개발자와 소비자가 겪는 배포 문제" 리서치입니다. 이 문제를 해결하는 것이 우리 해커톤의 목표입니다.)</p>

    <h3 style="font-size: 19px; margin-top: 25px; margin-bottom: 10px;">(A) "AWS 개발자"가 겪는 고통 (엔지니어 시점)</h3>
    <p style="margin: 0 0 15px 0;">핵심: <strong>fast 하면 unsafe해지고, safe 하려면 느려진다.</strong> "fast AND safe" 둘 다 잡는 장치가 필요합니다.</p>
    <ul style="margin-left: 20px; font-size: 16px;">
        <li><strong>롤백이 느리고 복잡:</strong> 새 버전이 터졌을 때 즉시 원복이 어렵습니다.</li>
        <li><strong>실패 원인 파악이 어려움:</strong> 로그가 여러 서비스에 흩어져 추적이 어렵습니다.</li>
        <li><strong>동시 배포 충돌:</strong> 여러 명이 동시에 배포하면 환경이 꼬입니다 (Race Condition).</li>
        <li><strong>Secret 관리의 위험:</strong> <code>.env</code> 파일이나 키 관리가 실수하기 쉽습니다.</li>
        <li><strong>환경 차이로 인한 오류:</strong> 로컬/Staging/Prod 환경이 달라 예측 불가능한 버그가 생깁니다.</li>
        <li><strong>배포에 대한 공포:</strong> 작은 변경이라도 "릴리스 = 고통/불안"으로 인식됩니다.</li>
    </ul>

    <h3 style="font-size: 19px; margin-top: 25px; margin-bottom: 10px;">(B) "일반 소비자"가 느끼는 불편 (소비자 시점)</h3>
    <p style="margin: 0 0 15px 0;">핵심: <strong>사람은 "버전 전환"을 느끼면 불편합니다.</strong> 배포는 "아무 일도 없었던 것처럼" 뒤에서 바뀌어야 합니다.</p>
    <ul style="margin-left: 20px; font-size: 16px;">
        <li><strong>순간적인 속도 저하:</strong> 배포 타이밍에 앱이 느려집니다.</li>
        <li><strong>순간적인 에러 발생:</strong> 롤링 배포 중간에 에러 페이지가 노출됩니다.</li>
        <li><strong>기능/버전 섞임:</strong> 캐시나 지역별 배포 차이로 버전이 섞여 보입니다.</li>
        <li><strong>새 기능 업데이트 지연:</strong> 릴리스가 제때 안 되거나 장애 공지가 없습니다.</li>
    </ul>

    <hr style="margin-top: 35px; margin-bottom: 35px; border: 0; border-top: 1px solid #eee;">

    <h2 style="font-size: 24px; margin-top: 30px;">2. 우리의 정의: "Delightful Deploy"란 무엇인가?</h2>
    <p style="font-size: 16px; font-style: italic; color: #555;">(이 정의는 위 1번의 문제들을 해결하며, 심사기준 4가지: 클라우드 활용/완성도/재미/팀개발을 모두 충족합니다.)</p>

    <h3 style="font-size: 19px; margin-top: 25px; margin-bottom: 10px;">(A) 비유: 배포는 테마파크 놀이기구다.</h3>
    <ul style="margin-left: 20px; font-size: 16px;">
        <li><strong>줄이 짧다 (대기시간↓):</strong> 클릭 한 번에 빠르게 탑승(배포).</li>
        <li><strong>안전바 단단 (안전장치↑):</strong> 문제 생겨도 즉시 원위치(롤백).</li>
        <li><strong>사진/성적표 제공 (관측↑):</strong> 전/후 성능·리소스 차이를 눈으로 확인.</li>
        <li><strong>친구랑 같이 탄다 (동시성↑):</strong> 여러 명이 동시에 안전하게 탑승(팀 협업/충돌 방지).</li>
        <li><strong>BGM/연출 (재미↑):</strong> "또 타고 싶다"는 감정이 남는다.</li>
    </ul>

    <h3 style="font-size: 19px; margin-top: 25px; margin-bottom: 10px;">(B) 실제 구현 (수정 완료)</h3>
    <ul style="margin-left: 20px; font-size: 16px;">
        <li><strong>입력:</strong> <code>main</code>에 merge or "Deploy" 버튼 클릭</li>
        <li><strong>자동 흐름:</strong> Lint/테스트/보안 스캔 → <strong>무중단 릴리스 (PM2 Reload)</strong> → 헬스체크 → (데모: <strong>Blue-Green 트래픽 전환</strong>) → 관측 대시보드 자동 스냅샷</li>
        <li><strong>안전장치:</strong> 실패 시 자동 롤백(30초 내), <strong>비밀키는 GitHub Secrets (SSH), EC2 접속 권한 최소화</strong></li>
        <li><strong>관측:</strong> 배포 직전/직후 지연시간·에러율·CPU 비교 카드가 <strong>GitHub Actions Summary에 자동 게시</strong></li>
        <li><strong>동시성:</strong> "배포 큐" 또는 환경 락으로 충돌 방지(직렬화)</li>
    </ul>

    <h3 style="font-size: 19px; margin-top: 25px; margin-bottom: 10px;">(C) 1줄 핵심</h3>
    <p style="font-size: 18px; font-weight: 500; background-color: #f4f4f4; padding: 15px; border-radius: 8px;">
        <strong>Delightful Deploy = 버튼 1번으로 빠르고 안전하며 보이는 변화가 있고, 여럿이 써도 안 부서지며, 심지어 재미까지 있는 배포 경험.</strong>
    </p>

    <hr style="margin-top: 35px; margin-bottom: 35px; border: 0; border-top: 1px solid #eee;">

    <h2 style="font-size: 24px; margin-top: 30px;">3. 실행 계획: 기술 스택 및 흐름</h2>
    <p style="font-size: 18px; font-weight: 500; background-color: #f4f4f4; padding: 15px; border-radius: 8px;">
        <strong>"Actions로 오케스트레이션·감사·동시성·가시성, PM2로 무중단/프로세스 관리"</strong>
    </p>

    <h3 style="font-size: 22px; margin-top: 30px;">🛠️ 핵심 기술 스택</h3>
    <ul>
        <li><strong>지휘 (Orchestration):</strong> GitHub Actions</li>
        <li><strong>인프라 (Infra):</strong> AWS EC2 (<strong>SSH</strong>로 접속)</li>
        <li><strong>트래픽 제어 (Gateway):</strong> Nginx (리버스 프록시, Blue/Green 전환용)</li>
        <li><strong>프로세스 관리 (Runner):</strong> PM2 (무중단 재시작)</li>
        <li><strong>관측 (Observability):</strong> Lighthouse, Autocannon (<strong>GitHub Summary</strong>에 리포트)</li>
        <li><strong>프론트엔드 타겟:</strong> Next.js 앱 (경로: <code>frontend/my-dashboard</code>). 구조 정비 완료로 <code>npm install</code>, <code>npm run dev</code>, <code>npm run build</code> 실행이 가능.</li>
    </ul>

    <h3 style="font-size: 22px; margin-top: 30px;">🌊 배포 파이프라인 흐름</h3>
    <ol>
        <li><strong>트리거:</strong> <code>main</code> 브랜치에 Push 또는 수동 "배포!" 버튼 클릭.</li>
        <li><strong>빌드/테스트:</strong> Actions가 Frontend/Backend 빌드 및 Lint/테스트 수행.</li>
        <li><strong>관측 (Pre-Deploy):</strong> Actions가 <strong>현재 운영 버전</strong>의 성능(LCP, p95) 스냅샷 저장.</li>
        <li><strong>배포:</strong> Actions가 <strong>EC2로</strong> 빌드 산출물(Artifact) 전송. (<strong>SSH/rsync</strong>)</li>
        <li><strong>EC2 파이프라인:</strong> Repo1을 체크아웃한 뒤 <strong><code>npm install</code></strong>을 실행하고, PM2로 <strong>`npm run dev`</strong>를 백그라운드에 기동합니다(기본 프로세스명 `frontend-dev`). 정적 산출물을 사용하지 않는 모드이며 필요 시 환경변수로 명령/출력 디렉터리를 커스터마이즈할 수 있습니다.</li>
        <li><strong>재시작:</strong> Actions가 <strong>EC2</strong>의 <code>pm2 reload all</code> 명령을 원격 실행 (무중단).</li>
        <li><strong>헬스 체크:</strong> Actions가 <strong>새 버전</strong>의 <code>/healthz</code> 엔드포인트를 1분간 체크.</li>
        <li><strong>관측 (Post-Deploy):</strong> Actions가 <strong>새 버전</strong>의 성능 스냅샷 저장.</li>
        <li><strong>리포트:</strong> <strong>"배포 전/후 성능 비교표"</strong>를 <strong>GitHub Actions Summary</strong>에 자동 게시.</li>
    </ol>

    <h3 style="font-size: 22px; margin-top: 30px;">🎯 핵심 데모 포인트 (심사위원 대상)</h3>
    <p>우리는 앱이 아닌, "배포 경험" 3가지를 시연합니다.</p>
    <ol>
        <li><strong>Nginx를 이용한 Blue/Green 배포:</strong> 버튼 하나로 트래픽을 즉시 전환/롤백하는 모습.</li>
        <li><strong>"보이는 변화" 리포트:</strong> GitHub Summary에 자동으로 게시된 "배포 전/후 성능 비교 카드".</li>
        <li><strong>자동 롤백:</strong> 헬스 체크 실패 시, 시스템이 자동으로 이전 버전으로 복귀하는 모습.</li>
    </ol>

    <hr style="margin-top: 35px; margin-bottom: 35px; border: 0; border-top: 1px solid #eee;">

    <h2 style="font-size: 24px; margin-top: 30px;">4. Q&A (주요 기능 설명)</h2>

    <h4 style="font-size: 18px; margin-bottom: 5px; margin-top: 20px;">Q: "수동 배포 버튼"이 무엇인가요?</h4>
    <p style="margin: 0 0 15px 0;">
        A: 우리가 만드는 버튼이 아니라, <strong>GitHub Actions의 <code>workflow_dispatch</code> 기능</strong>입니다. <code>.yml</code> 파일에 두 줄만 추가하면 "Actions" 탭에 <strong>"Run workflow" 버튼</strong>이 자동으로 생깁니다. 데모 시연 시 <code>push</code> 없이 이 버튼을 클릭해 배포를 시작합니다.
    </p>
    <h4 style="font-size: 18px; margin-bottom: 5px; margin-top: 20px;">Q: 롤백은 어떻게 동작하나요?</h4>
    <p style="margin: 0 0 15px 0;">
        A: <code>POST /api/v1/rollback</code>을 호출하면 최근 성공 배포 두 건을 확인해 최신 commit에서 바로 이전 commit으로 되돌립니다. 내부적으로 <code>git fetch</code>, <code>git checkout -B ... to_commit</code>, <code>git reset --hard</code>, <code>git clean -fdx</code>, <code>npm install</code> 후 동일한 PM2 `npm run dev` 명령을 재적용합니다. 실제 모드에서는 <code>git push origin +to_commit:branch</code>로 원격도 강제로 되돌립니다. (TIP: Repo1 <code>deploy</code> 브랜치에는 <code>frontend/my-dashboard</code>만 올려두세요.)</p>

    <h4 style="font-size: 18px; margin-bottom: 5px; margin-top: 20px;">Q: 백엔드 <code>/api/v1/deploy</code> 호출 시 어떤 입력이 필요한가요?</h4>
    <p style="margin: 0 0 15px 0;">
        A: 브랜치를 명시하지 않으면 기본적으로 <code>deploy</code> 브랜치를 사용합니다. 필요하다면 <code>{ "branch": "main" }</code>처럼 허용된 브랜치를 명시적으로 전송할 수도 있습니다. 다른 브랜치는 거부됩니다.
        작업자 추적은 Git 커밋 작성자 정보로 충분하다고 판단했습니다.
    </p>
    <h4 style="font-size: 18px; margin-bottom: 5px; margin-top: 20px;">Q: 테스트 모드(드라이런)와 실제 배포 모드는 어떻게 전환하나요?</h4>
    <p style="margin: 0 0 15px 0;">
        A: 기본값은 실제 명령 실행(<code>DEPLOY_DRY_RUN=false</code>)입니다. 시뮬레이션만 원하면 PM2를 재시작하기 전에 환경변수 <code>DEPLOY_DRY_RUN=true</code>를 설정하세요. MongoDB는 프로젝트 루트의 <code>./mongodb</code>, 데이터는 <code>./mongodb-data</code>에 위치합니다. 실제 배포 모드에서는 <code>git fetch → git checkout -B ... → git reset --hard → git clean -fdx → npm install</code> 순으로 Repo1 워킹 디렉터리를 교체한 뒤 PM2 `npm run dev` 명령을 실행합니다.</p>

    <h4 style="font-size: 18px; margin-bottom: 5px; margin-top: 20px;">Q: "관측 (Observability)"은 정확히 무엇을 하나요?</h4>
    <p style="margin: 0 0 15px 0;">
        A: "배포 전/후의 보이는 변화"를 증명하는 것입니다. <strong>Lighthouse</strong>(프론트 성능)와 <strong>Autocannon</strong>(백엔드 부하)같은 도구로 배포 *전*의 성능(LCP, p95 지연시간)을 측정하고, 배포 *후*에 다시 측정해서 비교 리포트를 만듭니다.
    </p>

    <h4 style="font-size: 18px; margin-bottom: 5px; margin-top: 20px;">Q: "GitHub Actions Summary" 리포트는 무엇인가요?</h4>
    <p style="margin: 0 0 15px 0;">
        A: <strong>각 Action 실행의 "결과 요약" 페이지</strong>입니다. GitHub에 영구적으로 기록됩니다. 위에서 측정한 "배포 전/후 성능 비교표"를 Markdown 테이블로 만들어 이 요약 페이지에 자동으로 게시, 배포 성과를 한눈에 볼 수 있게 합니다.
    </p>

</div>
